"$schema" = "node_modules/wrangler/config-schema.json"
name = "byrdocs"
main = "worker/index.ts"
compatibility_date = "2025-08-31"

[[durable_objects.bindings]]
name = "COUNTER"
class_name = "Counter"

[[durable_objects.bindings]]
name = "OAUTH"
class_name = "OAuth"

[[migrations]]
tag = "v1"
new_classes = [
    "Counter",
    "OAuth",
]

[observability]
enabled = true

[[d1_databases]]
binding = "DB"
database_name = "byrdocs"
database_id = "2df6319f-9c5f-4e3f-9958-3d0ab5f7825b"

[[r2_buckets]]
binding = "R2"
bucket_name = "byrdocs-file"
preview_bucket_name = "byrdocs-file"

[[analytics_engine_datasets]]
binding = "AE"
dataset = "byrdocs"

[triggers]
crons = ["0 0 * * *"]

[assets]
not_found_handling = "single-page-application"
run_worker_first = [
    "/api/*",
    "/schema/*",
    "/files/*",
]

[env.dev]
# BYR Docs Publish 的域名
VITE_PUBLISH_SITE_URL = "https://publish.byrdocs.cpphusky.xyz"
# 你的 byrdocs-archive 对应的 GitHub 仓库
VITE_ARCHIVE_REPO_URL = "https://github.com/byrdocs/byrdocs-archive-testing"
